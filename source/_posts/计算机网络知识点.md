---
title: 计算机网络期末总结 <概念篇>
date: 2019-07-04 00:14:00
categories: 期末总结系列
tags:
 - 计算机网络
---

此章用于计算机网络的期末复习总结。

<!--more-->

### 第一章概念总结 (总览)

- 计算机网络功能：
  - 数据通信 —— 传送计算机之间的各种信息
  - 资源共享 —— 共享软件、硬件、数据资源
  - 分布式处理 —— 均衡负载
- 计算机网络系统的基本组成
  - 组成部分：硬件、软件、协议
  - 工作方式：边缘部分、核心部分
  - 功能组成：通信子网（实现通信的设备和软件）、资源子网（实现资源共享的设备和软件）
    - **资源子网**表示七层架构的上三层（应、表、会）
    - **通信子网**则包括下三层（网、数、物）
  - 范围分为：广域网、城域网、局域网、个人区域网
    - 局域网和广域网覆盖范围不同，使用的协议亦不同
    - 广域网相当于是将n个局域网连通起来，使用的是点对点技术。而广域网继续扩大联通，则成为了互联网 Internet
    - 广域网与局域网的联通
      - 广域网是通过**交换机**及**路由器**所构成的
      - 局域网主要设备是**交换机**和主机。其中通信是通过广播的形式传递给信道上  的所有主机
      - 所以二者是以**路由器**联通的
  - 计算机网络拓扑结构主要取决于其**通信子网**。而拓扑结构（总线型、星型、环形、网状型）由于传输媒介起到一个通信的作用，故取决于下三层的**通信子网**
- 局域网中的主机由于只有一个 IP 网段，是工作在数据链路层的，单纯的进行 MAC 寻址即可，故无需通过网络层，自然也不存在路由选择问题
- 世界上最早的计算机网络是 ARPAnet。世界上最大的计算机网络是 Internet 
- 
- 
- 传输层提供端到端服务 —— 进程间逻辑通信
- 网络层、数据链路层、物理层提供点到点服务
  - 网络层 —— 主机间逻辑通信
  - 数据链路层 —— 节点间逻辑通信



| OSI七层    | 功能                                                         | 协议                           | 主要设备                  |
| ---------- | ------------------------------------------------------------ | ------------------------------ | ------------------------- |
| 应用层     | 终端应用：FTP、WEB、QQ                                       | FTP、HTTP、DNS、SMTP           | （网关）                  |
| 表示层     | 数据压缩、加密解密、数据格式转换                             |                                | （网关）                  |
| 会话层     | 为不同主机**进程**的会话，建立同步                           |                                | （网关）                  |
| 传输层     | 为端到端提供可靠的传输服务、进程通信<br />**差错控制**、**拥塞控制**、**流量控制** | TCP、UDP                       | （网关）                  |
| 网络层     | **路由选择、差错控制**、**拥塞控制**、**流量控制**           | IP、ICMP、RIP、OSPF、BGP、IGMP | 路由器                    |
| 数据链路层 | 寻址、成帧、**差错控制、流量控制**                           | PPP、ARP、RARP、MTU            | 交换机 switch、网桥、网卡 |
| 物理层     | 传输比特流，定义物理设备标准                                 | IEEE 802.1A、IEEE 802.2        | 集线器 Hub、中继器        |



- 服务、接口、协议是计算机网络中 OSI 参考模型的三个主要概念
  - 协议包函三个方面：语法（传输数据的格式）、语义（所要完成的功能）、同步 （执行各种操作的条件、时序关系）
  - **协议是水平的，是控制两个对等实体进行痛惜的规则**，即是控制两个对等实体进行通信的规则的集合。在协议的控制下，两个对等实体间的通信使得本层能够向上一层提供服务，而要实现本层协议，还需要使用下一层提供的服务。
  - **服务是垂直的，是由下层通过层间接口向上层提供的**
- 上下邻层实体之间的接口称为服务访问点。各层服务访问点对应关系如下



| 层级       | 访问点   |
| ---------- | -------- |
| 应用层     | 用户界面 |
| 传输层     | 端口号   |
| 网络层     | IP 地址  |
| 数据链路层 | MAC 地址 |
| 物理层     | 网卡接口 |

>发送时延 / 传输时延：将分组的所有比特推向链路的时间
>
>发送时延（传输时延） = 分组长度 / 信道宽度（带宽）
>
>传播时延：一个比特从链路一端到另一端传播的时间
>
>传播时延 = 信道长度 / 电磁波在信道上的传播速率

- 网络体系结构：计算机网络的各层及其协议的集合



- 计算机中的数据 传输/通信 分为穿行、并行、同步、异步
  - 串行传输：速度慢，费用低，始合远距离
  - 并行传输：速度快，费用高，适合近距离
  - 同步通信：发送方与接收方时钟**同步**，每次发送帧（一串字符）
  - 异步通信：发送方与接收方时钟**无同步**，每次发送一个字符

> 编码：
>
> 曼彻斯特编码：**前高后低为1，前低后高为0**（这个具体例子具体分析，有时候会相反，注意题设条件）
>
> ​		10baseT使用的就是曼彻斯特编码
>
> 差分曼彻斯特编码：**中间位置有跳变为0，中间位置无跳变为1**
>
> NRZI【非归零反向编码】：用电平的一次翻转来表示 Data 电平的逻辑 0 ，与前一个 NRZI 电平相同的电平表示 Data 电平的逻辑1

- 利用模拟通信信道传输数字信号的方法称为
- 基带传输：按照**数字信号**原有的波形（以脉冲形式）在**数字信道**上直接传输。通常对数字信号进行一定的编码。（**小范围**）
- 频带传输：将代表数据的二进制“1”和“0”，变换成具有一定频带范围的模拟信号，以适应在模拟信道上传输。**用于对数字信号进行调制、解调（大范围）**



- 数据在网络中的交换方式：
  - 电路交换：传输时延小，线路利用率低
  - 报文交换：线路利用率高，转发时延大
  - 分组交换：线路利用率高，传输时延较小，存储转发时延大
    - 虚电路：属于同一虚电路的分组按照同一路由转发。
    - 数据报：网络为每个分组独立选择路由，传输**不保证可靠性**，**也不保证分组按序到达**。
  - 信元交换：是一种面向连接的快速分组交换技术。它是通过建立虚电路来进行数据传输的。交换方式可以理解为结合了电路交换和报文交换



传输数字信号：

- 基带传输：按照数字信号原有的波形（以脉冲形式）在数字信道上直接传输。通常对数字信号进行一定的编码【小范围】
- 频道传输：将代表数据的二进制“1”和“0”，变换成具有一定频带范围的模拟信号，以适应在模拟信道上传输。对数字信号进行调制、解调【大范围】



>- 波特率【码元传输速率 / 码元速率 / 波形速率】：单位时间内数字通信系统所传输的码元个数（亦可称为**脉冲个数**或**信号变化的次数**），单位是波特（Baud 【码元 / s】）。1波特表示数字通信系统每秒传输一个码元
>- 比特率【信息传输速率 / 信息速率】：单位时间内数字通信系统所传输的二进制码元个数（比特数）
>- 若一个码元携带 n bit 的信息量，则 M Baud 的码元传输速率对应的信息传输速率为 M * n bit/s

- 波特率与数据率的转换关系： C = B * log2N 。此为理想情况
- 对于曼彻斯特编码来说码元有两个有效值，每转发一位就需要两个信号周期，故波特率是数据率的二倍

> **奈氏准则：**【信道无噪声用奈氏准则，有噪声用香农定理】
>
> <u>理想条件下，为了避免码间串扰，码元传输速率的上限理想低通信道下的极限数据传输率 = 2 W log2 V (b/s)</u>
>
> W为带宽 Hz，V为每个码元离散电平的数目（可以理解为码元的种类数。一个码元拥有 n 个 bit 位那么码元种类数就有2的n次方种）
>
> **香农定理**【带宽受限 + 有噪声】：
>
> 极限、无差错的信息传输速率。<u>信道的极限数据传输速率 C = W * log 2 (1 + S / N)</u>
>
> S为信道内所传信号的平均功率，N是信道内的高斯噪声功率，W为信道带宽，即无噪声时的传输速率





- 报文交换与分组交换的异同：

  - 同：存储转发、无需建立链接（不像电路交换需要建立链接，独占一条信道）

  - 异：

|              | 报文交换               | 分组交换             |
| :----------- | ---------------------- | -------------------- |
| 数据交换单位 | 报文（大小不固定且长） | 分组（大小固定且短） |
| 所需存储空间 | 大                     | 小                   |

  - 分组交换优点：

    - 缓冲区易于管理
    - 分组的平均延迟更小，网络中所占平均缓冲区更少
    - 更易标准化
    - 更适合应用



### 第二章概念总结 (物理层)

> 物理层功能：传输比特流，定义物理设备标准
>
> 物理层设备：
>
> - 中继器【转发器】：对信号进行**再生**和**还原**，适用于完全相同的**两类**网络的互联。不仅传送有用信号，同时也传送噪音和冲突信号。因而互相串联的个数只能在规定范围内进行，否则网络不可用
> - 集线器：**多端口**中继器，对信号**扩大转发**，同时把所有节点集中在以它为中心的节点上【物理结构为星型，而逻辑结构则是**总线型**。可以理解为是一个多端口的中继器】
>
> 物理层设备连接起来的网段是在一个冲突域里的，故其从属于一个局域网
>
> **物理层互联**，只表明这两个网段之间可以**互相传送物理信号**，**不保证传送帧**
>
> **链路层互联**，数据链路层协议和物理层协议相同，数据传输率也要相同，**保证传输帧和物理信号**
>
> 
>
> **5-4-3规则**：在10M以太网中，网络总长度不得超过5个区段，4台网络延长设备，且五个区段中只有三个区段可接网络设备。

 

- 两个网段在物理层进行互联时的要求
- 【网段】：一般指一个计算机网络中**使用同一物理层设备**（传输介质、中继器、集线器等）能够直接通讯的那一部分。eg: 从`192.169.0.1`到`192.168.255.255`之间就是一个网段



> **冲突域**：同一物理网段上所有节点的集合 or 以太网上**竞争**同一带宽的节点集合【网桥可以分开冲突域，但无法分开广播域】
>
> **广播域**：接收同样广播消息的节点的集合



|                                | 能否隔离冲突域 | 能够隔离广播域 |
| ------------------------------ | -------------- | -------------- |
| 物理层设备<br />中继器、集线器 | ×              | ×              |
| 链路层设备<br />网桥、交换机   | √              | ×              |
| 网络层设备<br />路由器         | √              | √              |

### 第三章概念总结 (链路层)

- 数据链路层五大功能
  - 为网络层提供服务【3种服务】
    - 有确认，无连接服务
    - 有确认，面向连接的服务
    - 无确认，无连接服务
    - 【不包含无确认的，面向连接的服务】
  - 链路管理：数据链路层的连接的建立、维持和释放
  - 帧定界、帧同步、透明传输
  - 流量控制：限制发送方速率
  - 差错控制：发送方保证接收方可以正确接收到发送的每一个数据【对位错和帧错的处理】



- 差错控制的情况
  - 位错【比特位出错，1变0，0变1】
    - CRC 循环冗余检验
    - 汉明码（海明码）：发现双比特错，纠正单比特错
  - 帧错
    - 丢失：通过计时器在规定时间内判定
    - 重复：给帧编号
    - 失序：后边的帧先到达，域一般的数据链路层传输概念不一样 

 

- 奇偶校验码智能检测出奇数个比特错误

- 海明【汉明】不等式：2的r次方 ≥ k + r + 1

|               | 海明距    |
| ------------- | --------- |
| 检测 d 比特错 | d + 1     |
| 纠正 d 比特错 | 2 * d + 1 |

- CRC 校验：计算冗余码

  - 加 0：假设生成多项式 G(x) 的阶为 r，则加 r 个 0 
  - 模 2 除法：数据加 0 后除以多项式，余数为冗余码 /FCS/CRC 检验码的比特序列。
  - 【和除法相同，唯一不一样的就是将原来的上下两层相减变为异或（同 0 异 1）】
  - 若余数为 0 则传输过程中未发生差错，否则发生。



- 信道利用率 = （L / C）/ T  【发送方在一个发送周期内，有效的发送数据所需要的时间占整个发送周期的比率】
  - T 内发送 L bit 数据
  - L：发送方数据传输率
  - 发送周期【从开始发送数据到收到第一个确认帧】



- ARQ 协议中，发送窗口的大小 ≤ 窗口总数 - 1

 

- FDM【时分复用】 与 TDM【频分复用】
  - TDM 抗干扰能力强，可以逐级再生整形，避免干扰的积累。而且**数字信号比较容易实现自动转换**
  - FDM 技术比较成熟，实现容易，且更能充分的利用带宽，**适用于模拟信号**





- 信道分配：
  - 静态 —— 信道划分介质访问控制【无冲突】
    - FDMA
    - CDMA
    - TDMA
  - 动态
    - 随机访问介质访问控制【冲突】
      - ALOHA
      - CSMA
      - CSMA / CD ：碰撞检测【更适用于有线网络】
        - 先听后发
        - 边听边发
        - 冲突停发 
        - 随机重发
      - CSMA / CA ：碰撞避免【更适用于无线网络】
    - 轮询访问戒指访问控制 —— 令牌传递协议【无冲突】



- 最小帧长 = 总线传播时延 * 数据传输速率 * 2



> 局域网【Local Area Network】：在**某一区域内**由多台计算机互联成的计算机组，使用**广播信道**
>
> 特点：
>
> - 覆盖的地理范围较小，址在一个相对独立的局部范围内联
> - 使用专门铺设的传输介质（双绞线、同轴电缆）进行联网，数据传输速率高
> - 通信延迟时间短，误码率低，可靠性较高
> - 各站点为平等关系，共享传输信道
> - 多采用分布式控制和广播式通信，能进行广播和组播
>
> 决定局域网的主要要素为：**网络拓扑**、**传输介质**与**介质访问控制方法**



以太网提供无连接、不可靠的服务

- 无连接：发送方和接收方之间无“握手过程”【传输数据之前不用建立链接】
- 不可靠：不对发送方的数据帧**编号**，接收方**不**向发送方进行**确认**，差错帧直接丢弃，**差错纠正由高层负责**
- 因为局域网的信道质量非常好，产生错误的概率较低，故采用无连接、不可靠的措施
- **以太网参考模型一般只包括物理层和数据链路层** 
- 以太网逻辑拓扑为**总线型**，物理拓扑为星形或**拓展星型**

![](https://pic.superbed.cn/item/5d138728451253d17877f5ae.png)



- mac 帧头结构



![](https://ae01.alicdn.com/kf/HTB1CzeTef1H3KVjSZFH762KppXaD.png)

mac 地址的分配基于**制造商**，而 IP 地址的分配是基于**网络拓扑**。故 **IP 地址唯一，而 mac 地址不唯一**

- 相同静态 MAC 地址，不能正确通信
  - 目的 MAC 地址等于本机 MAC 地址的帧是**不会被发送到网络上去**的
  - 其他设备的用户发送给 A 的帧也会被 B 接收，B 必须处理不属于本设备的帧，**浪费**了资源
  - 正确实现的 ARP 软件都会禁止把同一个 MAC 地址绑定到两个不同的 IP 地址，防止 A 和 B 在会话时都**时断时续**



- 数据链路层
  - LLC 逻辑链路控制【面向网络层】：向网络层提供服务，LLC 报头告诉数据链路层一旦帧被接收到时，应对应数据包作何处理
    - **建立和释放数据链路层的逻辑链接**
    - **提供与高层的接口**
    - **差错控制**
    - **给帧加序号**
    - 与传输媒体无关
  - MAC 媒体访问控制【面向物理层】：与传输媒体有关
    - **组帧和拆帧**
    - **比特差错检测**
    - **寻址**
    - **竞争处理**



| ≤ 1Gb/s 的以太网 | 半双工/全双工 | 可能有争用问题 | 可能用CSMA / CD |
| ---------------- | --------|------ | --------------- |
| **≥ 10Gb/s的以太网** | **全双工**     |       **无争用问题**       |**不会用CSMA/CD** |



> 令牌环网机制：
>
> 某台主机获得令牌后将要发送的数据附着其上，并让令牌进入环路。若令牌所携带目标 MAC 地址与换路上主机 MAC 地址相同则将数据复制给环路，然后重新回到出发点。出发点再生成新的令牌移交给下一台主机
>
> 结点只能在一定时间内（持有令牌时）发送数据



- PPP协议（**只支持全双工链路，点对点连接**）
  - 简单【对于链路层的帧，**无需纠错**，**无需序号**，**无需流量控制**】
  - 封装成帧【帧定界符】
  - 透明传输【与帧定界符一样比特组合的数据应该如何处理：异步线路用字节填充，同步线路用比特填充】
  - 多种网络协议【封装的 IP 数据可以采用多种协议】
  - 多种类型链路：串行/并行，同步/异步，电/光。。。
  - **差错检测**【**错就丢弃**】
  - **只支持全双工链路**
  - **两端可以运行不同的网络协议**
  - **面向字节**
  - 检测连接状态【链路是否正常工作】
  - 最大传送单元【最大长度MTU，默认不超过1500字节】
  - 网络层地址协商【知道通信双方的网络层地址】
  - 数据压缩协商
- PPP协议的三个组成部分
  - 一个将 IP 数据封装到串行链路（同步串行 / 异步串行）的方法
  - 链路控制协议 LCP：建立并维护数据链路连接【身份验证】
  - 网络控制协议 NCP：PPP可支持多种网络协议。每个不同的网络层协议都要一个相应的 NCP 来配置，为网络层协议建立和配置逻辑连接

![PPP协议状态图](https://ae01.alicdn.com/kf/HTB1xpm4eoGF3KVjSZFo762mpFXal.png)

![PPP协议的帧格式](https://ae01.alicdn.com/kf/HTB1wxW7ekWE3KVjSZSy760ocXXaN.png)

PPP 协议和 HDLC 协议的差别

![PPP 协议和 HDLC 协议的差别](https://ae01.alicdn.com/kf/HTB1NHO5eoGF3KVjSZFm762qPXXa8.png)

> 上图中 HDLC 帧的首尾标志F是遗传特定的编号`01111110`。若中间部分的信息流出现了这样的组成结构那么我们会通过**比特填充的首尾标志法**实现透明传输。即，**若有六个`1`连在一起，那么在`5`个`1`后边填上一个`0`**





- 我们如果想要扩展以太网，在物理层可以通过**主干集线器**将多个集线器连接起来，使他们构成一个大的冲突域：
  - 可以进行跨域通讯。
  - 扩大了以太网的覆盖范围。
  - 但是实际通讯效率变低，因为发生冲突概率变高。为解决此问题我们可以在链路层对以太网进行扩展，以达到减少冲突，提高效率的目的：
- 链路层扩展以太网【**网桥**&**交换机**】
  - 网桥可以根据 MAC 帧的目的地址，对帧进行转发和过滤。当网桥收到一个帧时，并不向所有接口转发此帧，二十先检查此帧的目的 MAC 地址，然后再确定将该帧转发到哪一个接口，或是把它丢弃（过滤）
    - 网段：一般指一个计算机网络中使用同一物理层设备能够直接通讯的那一部分。我们将多个网段用网桥连接
    - 网桥优点：
      - 过滤通信量，增大吞吐量
      - 扩大了物理传输范围
      - 提高了可靠性
      - **可互联不同物理层、不同 MAC 子层和不同速率的以太网**
    - 源路由网桥：确定一个最佳路由，将最佳路由信息放入帧的首部。源和目标地址符合则按照帧首中的信息走
    - 透明网桥：通过自学习算法构建一个转发表



- 冲突域和广播域
  
  - > 冲突域：同一物理网段上所有节点的集合 or 以太网上竞争同一带宽的节点集合
    >
    > 广播域：接受同样广播消息的节点集合
    
  - 冲突域：在同一个冲突域中每一个节点都能收到所有被发送的帧。【同一时间内只能有一台设备发送信息的范围】
  
    - 判别方法：**链路层设备的一个端口就是一个冲突域**
  - 广播域：网络中能接收任一设备发出的广播帧的所有设备的集合。【若站点发出一个广播信号，所有能接收到这个信号的设备范围成为一个广播域】
  
    - 判别方法：**若有路由器则路由器分出几条线就有几个广播域，无路由器则只有一个广播域**



> 广域网通常指覆盖范围很广的长距离网络。它由一些结点交换机以及连接这些交换机的链路组成。节点交换机执行分组**存储转发**功能



- 集中控制式：整个交换机所有的控制功能，包括呼叫处理和维护管理功能，都集中在一个处理机上（中央处理机）
- 分布控制式：含有几组功能部件的公共控制方式

### 第四章概念总结 (网络层)

- 网络层功能：
  - 异构网络互连：异构指传输介质、数据编码方式、链路控制协议以及不同的数据单元格式和转发机制
  - 路由与转发：选路由、选端口
  - 拥塞控制：



- 路由器连接的异构网络指的是**数据链路层和物理层均不同**
- 路由器连接的多个局域网要求**物理层**、**链路层**、**网络层**协议可以不同，而**网络层以上的高层协议必须相同**



- 路由选择算法
  - 静态：管理员手工配置路由信息
  - 动态
    - 距离 - 向量路由算法【RIP】：要求每个路由器定期与**所有相邻路由器**交换整个路由表，更新自己的路有表项
      - RIP：坏消息传得慢 / 路由收敛慢。互相信任彼此，将跳数增加。直至两方都增至16，才知道数据不可达
    - 链路状态路由算法【OSPF】



- IP 分组交付方式
  - 直接交付：（目的 IP & 发送口掩码） = （源 IP & 发送口掩码）【**子网地址是否相同**】
  - 间接交付：（目的 IP & 发送口掩码） ≠ （源 IP & 发送口掩码）
  - **直接交付是将目的 IP 地址转换为物理地址，而间接交付则是将下一跳 IP 地址转化为物理地址（ARP协议）**



- 在数据报到达具体的目的网络后，需要知道目的主机的 **MAC地址**【数据链路层中 MAC 地址用来标识主机或路由器】 才能被成功送达
  - **MAC地址也就是其对应的物理地址或硬件地址，二者通过 ARP 协议转换为 MAC 地址**



- IP 地址资源宝贵，由于很多用户上网时间和空间的离散性，故每次拨号上网后都会被电信分配一个随机的 IP 地址。
  - **域名和 IP 地址即可以是一对多亦可以是多对一**



![网络类别](https://ae01.alicdn.com/kf/HTB1zHYsev5G3KVjSZPx762I3XXab.png)

> 补充一下上图。**主机号全`1`的话则代表是一个广播地址**，**主机号全`0`则代表本网络**
>
> 若为`224`开头，则代表网络类型为**`D类`**，其中的地址全为**组播地址**。
>
> 而当我们碰到诸如`192.168.24.59/30`的地址时，先将后部分的`59`化为二进制`00111011`，后边的`/30`代表`CIDR`无分类编址，所以前`30`位为**网络位**，而后两位为**主机位**。主机位为全 1，故此地址为广播地址。**而主机号非全 1 则为单播地址**
>
> 可以接收到广播分组的主机需要除去主机号全`0`和全`1`的地址

把 IP 网络划分成子网，这样做可以方便我们对每个小网络问题的排查。既可以减轻我们的工作量也可以加快我们的效率

划分子网时我们要看`CIDR`无分类编址后边的位数。用`32`减去"`/`"的数字即是我们的`子网+IP`。其中前面是 子网号后边是`IP`。

其中子网号既不能为全`0`亦不可为全`1`，而 **IP 则是2的剩余的位数的幂次方**。又 IP 不能为全`0`或全`1`，所以需要在此基础上`-2` 

- 例题：某网络的 IP 地址空间为`192.168.5.0/24`，采用定长子网划分，子网掩码为`255.255.255.248`，则该网络中的最大子网个数、每个子网内的最大可分配地址个数分别为：
  - 分析：`192.168.5.0/24`，网络号为前24位，则后8位为子网号 + 主机号。
  - 子网掩码为`255.255.255.248`，第四个字节`248`转为二进制：`11111000`，故前五位为子网号，后三位为  IP，故子网有32个
  - 每个子网最大可分配地址则是用`8 - 2 = 6`个主机地址



![IPv6数据报格式](https://ae01.alicdn.com/kf/HTB1oI3FeAWE3KVjSZSy760ocXXa1.png)

![ipv6首部](https://ae01.alicdn.com/kf/HTB1TfXve79E3KVjSZFG76319XXaT.png)

- 解决 IP 地址耗尽
  - 划分子网：主机号借用若干比特作为子网号，从而对原来较大规模的网络细分成几个规模较小的网络，提高了 IP 地址的利用率
  - CIDR：使用各种长度的网络前缀来代替分类地址中的网络号和子网号，将网络前缀都相同的 IP 地址组成”CIDR 地址块“
  - NAT 网络地址转换：只要一个全球 IP 地址，就可以让多台主机同时访问因特网
  - IPv6：从根本上扩充 IP 资源短缺问题
    - IPv4有 4B 的内存来进行编制
    - IPv6 有 16B 的内存进行编制

>- `IPv6`和`IPv4`的区别
>  - 地址空间变大——4B ➡16B
>  - IPv6 将 IPv4 的**校验和字段彻底移除**，以减少每跳的处理时间
>  - IPv6 将 IPv4 的可选字段移出首部，变成了**扩展首部**，成为灵活的首部格式。路由器通常不对扩展首部进行检查，大大提高了路由器的处理效率
>  - IPv6 支持即插即用（自动配置），不需要 DHCP 协议
>  - IPv6 首部长度必须是 **8B 的整数倍**。IPv4 首部是 **4B 的整数倍**
>  - IPv6 **只能在主机处分片**，IPv4 可以在路由器和主机处分片
>  - ICMPv6：差错检测协议添加报文类型“分组过大”
>  - IPv6 支持资源的预分配，支持实时视像等要求，保证一定的带宽和时延的应用
>  - IPv6 取消了协议字段，改成下一个首部字段
>  - IPv6 取消了总长度字段，改用有效载荷长度字段
>  - IPv6 取消了服务类型字段



- IPv4 表示形式为**点分十进制**，而 IPv6 则用**冒号十六进制**表示



- 一些常用的 IP 地址
  - `0.0.0.0`：本主机在本网络上的源地址。只能作为 IP 分组的源 IP 地址但不能作为目的 IP 地址
  - 
  - `255.255.255.255`：整个 TCP/IP 的广播地址，又称受限广播地址
  - `127.0.0.1`：环路自检地址，表示任意主机本身。
    - 目的地址为环回地址的 IP 数据报永远不会出现在网络上。



- IP 数据报的准备和传递过程
  - 传输层分片（数据长度过大强制分片）
  - 网络层封装（加上源 IP 地址和目的 IP 地址）
  - 数据链路层封装（加上源 MAC 和目的 MAC 地址）【硬件地址具有本地意义，故不同子网间进行通信时都必须**重新封装源 MAC 地址和目的 MAC 地址**】
  - 物理层以比特流的形式放在链路上进行传输



- ARP 协议：**将 IP 地址解析为数据链路层的 MAC 地址**，及**解析下一跳的地址**
- ARP-A协议：将 MAC 地址转化为 IP 地址
- DNS协议：根据域名查询 IP 地址【`ping`】、根据 IP 地址查询域名【`nslookup`】



- 关于 IP 层的 ARP 协议
  - IP 层（网络层）包函 ARP协议、 IP协议、ICMP协议和 IGMP协议，其中 ARP协议是为 IP协议服务的，而 IP协议又为 ICMP和IGMP协议服务
  - 请求分组对应广播方式，响应分组对应单播的方式
  - 当响应回应给请求方信息后，会将响应地址的 MAC 封装在数据链路层的数据帧中。之后若向响应方传递信息则从自己的 ARP 表中查到相应地址后封装在帧中直接传递



- ICMP报文
  - ICMP差错报告报文
    - 终点不可达
    - 源点抑制
    - 时间超过（`Traceroute`跟踪分组经过的路由）
    - 参数问题
    - 改变路由 / 重定向
  - ICMP询问报文
    - 回送请求和回答报文（`PING`测试两主机间连通性）
    - 时间戳请求和回答报文
    - 掩码地址请求报文
    - 路由器询问和通告报文
  - 不发送 ICMP 差错报告报文的几种情况
    - 对 **ICMP 差错报告报文**不再发送 ICMP 差错报告报文
    - 对第一个分片的数据报片的**所有后续数据报片**都不发送 ICMP 差错报告报文
    - 对具有**组播地址**的数据报都不发送 ICMP 差错报告报文
    - 对具有特殊地址（如**环回地址**【127.0.0.1】或**本网络本主机**【0.0.0.0】）的数据报不发送 ICMP 差错报告报文



|      | 地址位数     | 是否有校验和字段               | IP 报头         | 在路由分片 |
| ---- | ------------ | ------------------------------ | --------------- | ---------- |
| IPv4 | 32位（4B）   | 有                             | 20-60B 可变长度 | 是         |
| IPv6 | 128位（16B） | 无（加快路由器处理数据报速度） | 40B 长度固定    | 否         |



- RIP 是一种分布式的基于距离向量的路由选择协议，通过广播 UDP 报文来交换路由信息
- OSPF 是一个内部网关协议，要交换的信息量较大，应使报文的长度尽量短，所以不适用传输层协议（UDP或TCP），而直接采用 IP
- BGP 是一个外部网关协议，在不同的自治系统之间交换路由信息。由于网络环境复杂，需要保证可靠传输，所以采用 TCP









